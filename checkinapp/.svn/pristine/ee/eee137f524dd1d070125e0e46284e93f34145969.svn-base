jQuery(document).ready(function(){
 var IW = IW || {};
    (function( IW ) {
        var secondsInADay = 86400;
        function PasswordValidator() {
        }
        PasswordValidator.prototype.passwordLifeTimeInDays = 365;
        PasswordValidator.prototype.passwordAttemptsPerSecond = 500;
        PasswordValidator.prototype.expressions = [
            {
                regex: /[A-Z]+/,
                uniqueChars: 26
            },
            {
                regex: /[a-z]+/,
                uniqueChars: 26
            },
            {
                regex: /[0-9]+/,
                uniqueChars: 10
            },
            {
                regex: /[!\?.;,\\@$Â£#*()%~<>{}\[\]]+/,
                uniqueChars: 17
            }
        ];
        PasswordValidator.prototype.checkPassword = function( password ) {

            var
                    expressions = this.expressions,
                    i,
                    l = expressions.length,
                    expression,
                    possibilitiesPerLetterInPassword = 0;

            for ( i = 0; i < l; i++ ) {

                expression = expressions[i];

                if ( expression.regex.exec(password) ) {
                    possibilitiesPerLetterInPassword += expression.uniqueChars;
                }

            }

            var
                    totalCombinations = Math.pow(possibilitiesPerLetterInPassword, password.length),
                    // how long, on average, it would take to crack this (@ 200 attempts per second) 
                    crackTime = ((totalCombinations / this.passwordAttemptsPerSecond) / 2) / secondsInADay,
                    // how close is the time to the projected time? 
                    percentage = crackTime / this.passwordLifeTimeInDays;

            return Math.min(Math.max(password.length * 8, percentage * 100), 100);

        };

        IW.PasswordValidator = new PasswordValidator();

    })(IW);

    /** 
     * jQuery plugin which allows you to add password validation to any 
     * form element. 
     */
    (function( IW, jQuery ) {

        function updatePassword() {

            var
                    percentage = IW.PasswordValidator.checkPassword(this.val()),
                    progressBar = this.parent().find(".passwordStrengthBar div");

            progressBar
                    .removeClass("strong medium weak useless")
                    .stop()
                    .animate({"width": percentage + "%"});

            if ( percentage > 105 ) {
                progressBar.addClass("strong");
            } else if ( percentage > 80 ) {
                progressBar.addClass("medium")
            } else if ( percentage > 45 ) {
                progressBar.addClass("weak");
            } else {
                progressBar.addClass("useless");
            }
        }

        jQuery.fn.passwordValidate = function() {

            this
                    .bind('keyup', jQuery.proxy(updatePassword, this))
                    .after("<div class='passwordStrengthBar'>" +
                            "<div></div>" +
                            "</div>");

            updatePassword.apply(this);

            return this; 
        }

    })(IW, jQuery);
    jQuery("input[id='pwd1']").passwordValidate();
	});
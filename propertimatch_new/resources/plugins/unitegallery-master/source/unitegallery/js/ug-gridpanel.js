function UGGridPanel(){var t=this,g_objThis=jQuery(this);var g_gallery=new UniteGalleryMain(),g_objGallery,g_objWrapper,g_objPanel;var g_functions=new UGFunctions();var g_objGrid=new UGThumbsGrid();var g_panelBase=new UGPanelsBase();var g_objArrowNext,g_objArrowPrev;this.events={FINISH_MOVE:"gridpanel_move_finish",OPEN_PANEL:"open_panel",CLOSE_PANEL:"close_panel"};var g_options={gridpanel_vertical_scroll:true,gridpanel_grid_align:"middle",gridpanel_padding_border_top:10,gridpanel_padding_border_bottom:4,gridpanel_padding_border_left:10,gridpanel_padding_border_right:10,gridpanel_arrows_skin:"",gridpanel_arrows_align_vert:"middle",gridpanel_arrows_padding_vert:4,gridpanel_arrows_align_hor:"center",gridpanel_arrows_padding_hor:10,gridpanel_space_between_arrows:20,gridpanel_arrows_always_on:false,gridpanel_enable_handle:true,gridpanel_handle_align:"top",gridpanel_handle_offset:0,gridpanel_handle_skin:"",gridpanel_background_color:""};var g_defaultsVertical={gridpanel_grid_align:"middle",gridpanel_padding_border_top:2,gridpanel_padding_border_bottom:2};var g_defaultsHorType={gridpanel_grid_align:"center"};var g_temp={panelType:"grid",isHorType:false,arrowsVisible:false,panelHeight:0,panelWidth:0,originalPosX:null,isEventsInited:false,isClosed:false,orientation:null};function initGridPanel(gallery,customOptions){g_gallery=gallery;validateOrientation();if(customOptions&&customOptions.vertical_scroll){g_options.gridpanel_vertical_scroll=customOptions.vertical_scroll;}g_options=jQuery.extend(g_options,customOptions);if(g_temp.isHorType==true){g_options=jQuery.extend(g_options,g_defaultsHorType);g_options=jQuery.extend(g_options,customOptions);}else if(g_options.gridpanel_vertical_scroll==true){g_options=jQuery.extend(g_options,g_defaultsVertical);g_options=jQuery.extend(g_options,customOptions);g_options.grid_panes_direction="bottom";}var galleryOptions=g_gallery.getOptions();var globalSkin=galleryOptions.gallery_skin;if(g_options.gridpanel_arrows_skin=="")g_options.gridpanel_arrows_skin=globalSkin;var objects=gallery.getObjects();g_objWrapper=objects.g_objWrapper;g_panelBase.init(g_gallery,g_temp,t,g_options,g_objThis);g_objGrid=new UGThumbsGrid();g_objGrid.init(g_gallery,g_options);}function validateOrientation(){if(g_temp.orientation==null)throw new Error("Wrong orientation, please set panel orientation before run");}function runPanel(){validateOrientation();processOptions();g_objGrid.run();setArrows();setPanelSize();placeElements();initEvents();}function setHtmlPanel(){g_objWrapper.append("<div class='ug-grid-panel'></div>");g_objPanel=g_objWrapper.children('.ug-grid-panel');if(g_temp.isHorType){g_objPanel.append("<div class='grid-arrow grid-arrow-left-hortype ug-skin-"+g_options.gridpanel_arrows_skin+"'></div>");g_objPanel.append("<div class='grid-arrow grid-arrow-right-hortype ug-skin-"+g_options.gridpanel_arrows_skin+"'></div>");g_objArrowPrev=g_objPanel.children(".grid-arrow-left-hortype");g_objArrowNext=g_objPanel.children(".grid-arrow-right-hortype");}else if(g_options.gridpanel_vertical_scroll==false){g_objPanel.append("<div class='grid-arrow grid-arrow-left ug-skin-"+g_options.gridpanel_arrows_skin+"'></div>");g_objPanel.append("<div class='grid-arrow grid-arrow-right ug-skin-"+g_options.gridpanel_arrows_skin+"'></div>");g_objArrowPrev=g_objPanel.children(".grid-arrow-left");g_objArrowNext=g_objPanel.children(".grid-arrow-right");}else{g_objPanel.append("<div class='grid-arrow grid-arrow-up ug-skin-"+g_options.gridpanel_arrows_skin+"'></div>");g_objPanel.append("<div class='grid-arrow grid-arrow-down ug-skin-"+g_options.gridpanel_arrows_skin+"'></div>");g_objArrowPrev=g_objPanel.children(".grid-arrow-up");g_objArrowNext=g_objPanel.children(".grid-arrow-down");}g_panelBase.setHtml(g_objPanel);g_objArrowPrev.fadeTo(0,0);g_objArrowNext.fadeTo(0,0);g_objGrid.setHtml(g_objPanel);setHtmlProperties();}function setHtmlProperties(){if(g_options.gridpanel_background_color!="")g_objPanel.css("background-color",g_options.gridpanel_background_color);}function processOptions(){if(g_options.gridpanel_grid_align=="center")g_options.gridpanel_grid_align="middle";}function placePanelAnimation(panelX,functionOnComplete){var objCss={left:panelX+"px"};g_objPanel.stop(true).animate(objCss,{duration:300,easing:"easeInOutQuad",queue:false,complete:function(){if(functionOnComplete)functionOnComplete();}});}function getGridMaxHeight(){var spaceTaken=g_options.gridpanel_padding_border_top+g_options.gridpanel_padding_border_bottom;var maxGridHeight=g_temp.panelHeight-spaceTaken;if(g_options.gridpanel_arrows_always_on==false){var numPanes=g_objGrid.getNumPanesEstimationByHeight(maxGridHeight);if(numPanes==1)return(maxGridHeight);}var arrowsSize=g_functions.getElementSize(g_objArrowNext);var arrowsHeight=arrowsSize.height;var spaceTaken=arrowsHeight+g_options.gridpanel_arrows_padding_vert;if(g_options.gridpanel_vertical_scroll==true)spaceTaken*=2;spaceTaken+=g_options.gridpanel_padding_border_top+g_options.gridpanel_padding_border_bottom;maxGridHeight=g_temp.panelHeight-spaceTaken;return(maxGridHeight);}function getGridMaxWidth(){var spaceTaken=g_options.gridpanel_padding_border_left+g_options.gridpanel_padding_border_right;var maxGridWidth=g_temp.panelWidth-spaceTaken;if(g_options.gridpanel_arrows_always_on==false){var numPanes=g_objGrid.getNumPanesEstimationByWidth(maxGridWidth);if(numPanes==1)return(maxGridWidth);}var arrowsSize=g_functions.getElementSize(g_objArrowNext);var arrowsWidth=arrowsSize.width;spaceTaken+=(arrowsWidth+g_options.gridpanel_arrows_padding_hor)*2;maxGridWidth=g_temp.panelWidth-spaceTaken;return(maxGridWidth);}function setArrows(){var showArrows=false;if(g_options.gridpanel_arrows_always_on==true){showArrows=true;}else{var numPanes=g_objGrid.getNumPanes();if(numPanes>1)showArrows=true;}if(showArrows==true){g_objArrowNext.show().fadeTo(0,1);g_objArrowPrev.show().fadeTo(0,1);g_temp.arrowsVisible=true;}else{g_objArrowNext.hide();g_objArrowPrev.hide();g_temp.arrowsVisible=false;}}function setPanelSize(){var gridSize=g_objGrid.getSize();if(g_temp.isHorType==true)g_temp.panelHeight=gridSize.height+g_options.gridpanel_padding_border_top+g_options.gridpanel_padding_border_bottom;else
g_temp.panelWidth=gridSize.width+g_options.gridpanel_padding_border_left+g_options.gridpanel_padding_border_right;g_functions.setElementSize(g_objPanel,g_temp.panelWidth,g_temp.panelHeight);}function placePanelNoAnimation(panelDest){switch(g_temp.orientation){case"right":case"left":g_functions.placeElement(g_objPanel,panelDest,null);break;}}function __________EVENTS___________(){};function onPanelSlideFinish(){g_objThis.trigger(t.events.FINISH_MOVE);}function initEvents(){if(g_temp.isEventsInited==true)return(false);g_temp.isEventsInited=true;if(g_objArrowPrev){g_functions.addClassOnHover(g_objArrowPrev);g_objGrid.attachPrevPaneButton(g_objArrowPrev);}if(g_objArrowNext){g_functions.addClassOnHover(g_objArrowNext);g_objGrid.attachNextPaneButton(g_objArrowNext);}g_panelBase.initEvents();}this.destroy=function(){if(g_objArrowPrev)g_functions.destroyButton(g_objArrowPrev);if(g_objArrowNext)g_functions.destroyButton(g_objArrowNext);g_panelBase.destroy();g_objGrid.destroy();}
function ______PLACE_ELEMENTS___________(){};function getGridPaddingLeft(){var gridPanelLeft=g_options.gridpanel_padding_border_left;return(gridPanelLeft);}function placeElements_noarrows(){var gridY=g_options.gridpanel_grid_align,gridPaddingY=0;switch(gridY){case"top":gridPaddingY=g_options.gridpanel_padding_border_top;break;case"bottom":gridPaddingY=g_options.gridpanel_padding_border_bottom;break;}var gridPanelLeft=getGridPaddingLeft();var gridElement=g_objGrid.getElement();g_functions.placeElement(gridElement,gridPanelLeft,gridY,0,gridPaddingY);}function placeElementsVert_arrows(){var gridY,prevArrowY,nextArrowY,nextArrowPaddingY;var objArrowSize=g_functions.getElementSize(g_objArrowPrev);var objGridSize=g_objGrid.getSize();switch(g_options.gridpanel_grid_align){default:case"top":gridY=g_options.gridpanel_padding_border_top+objArrowSize.height+g_options.gridpanel_arrows_padding_vert;break;case"middle":gridY="middle";break;case"bottom":gridY=g_temp.panelHeight-objGridSize.height-objArrowSize.height-g_options.gridpanel_padding_border_bottom-g_options.gridpanel_arrows_padding_vert;break;}var gridPanelLeft=getGridPaddingLeft();var gridElement=g_objGrid.getElement();g_functions.placeElement(gridElement,gridPanelLeft,gridY);var objGridSize=g_objGrid.getSize();switch(g_options.gridpanel_arrows_align_vert){default:case"center":case"middle":prevArrowY=(objGridSize.top-objArrowSize.height)/2;nextArrowY=objGridSize.bottom+(g_temp.panelHeight-objGridSize.bottom-objArrowSize.height)/2;nextArrowPaddingY=0;break;case"grid":prevArrowY=objGridSize.top-objArrowSize.height-g_options.gridpanel_arrows_padding_vert_vert
nextArrowY=objGridSize.bottom+g_options.gridpanel_arrows_padding_vert;nextArrowPaddingY=0;break;case"border":case"borders":prevArrowY=g_options.gridpanel_padding_border_top;nextArrowY="bottom";nextArrowPaddingY=g_options.gridpanel_padding_border_bottom;break;}g_functions.placeElement(g_objArrowPrev,"center",prevArrowY);g_functions.placeElement(g_objArrowNext,"center",nextArrowY,0,nextArrowPaddingY);}function placeElementsVert(){if(g_temp.arrowsVisible==true)placeElementsVert_arrows();else
placeElements_noarrows();}function placeElementsHor_arrows(){var arrowsY,prevArrowPadding,arrowsPaddingY,nextArrowPadding;var objArrowSize=g_functions.getElementSize(g_objArrowPrev);var objGridSize=g_objGrid.getSize();var gridY=g_options.gridpanel_padding_border_top;switch(g_options.gridpanel_grid_align){case"middle":switch(g_options.gridpanel_arrows_align_vert){default:var elementsHeight=objGridSize.height+g_options.gridpanel_arrows_padding_vert+objArrowSize.height;gridY=(g_temp.panelHeight-elementsHeight)/2;break;case"border":case"borders":var remainHeight=g_temp.panelHeight-objArrowSize.height-g_options.gridpanel_padding_border_bottom;gridY=(remainHeight-objGridSize.height)/2;break;}break;case"bottom":var elementsHeight=objGridSize.height+objArrowSize.height+g_options.gridpanel_arrows_padding_vert;gridY=g_temp.panelHeight-elementsHeight-g_options.gridpanel_padding_border_bottom;break;}var gridElement=g_objGrid.getElement();var gridPanelLeft=getGridPaddingLeft();g_functions.placeElement(gridElement,gridPanelLeft,gridY);var objGridSize=g_objGrid.getSize();switch(g_options.gridpanel_arrows_align_vert){default:case"center":case"middle":arrowsY=objGridSize.bottom+(g_temp.panelHeight-objGridSize.bottom-objArrowSize.height)/2;arrowsPaddingY=0;break;case"grid":arrowsY=objGridSize.bottom+g_options.gridpanel_arrows_padding_vert;arrowsPaddingY=0;break;case"border":case"borders":arrowsY="bottom";arrowsPaddingY=g_options.gridpanel_padding_border_bottom;break;}prevArrowPadding=-objArrowSize.width/2-g_options.gridpanel_space_between_arrows/2;g_functions.placeElement(g_objArrowPrev,"center",arrowsY,prevArrowPadding,arrowsPaddingY);var nextArrowPadding=Math.abs(prevArrowPadding);g_functions.placeElement(g_objArrowNext,"center",arrowsY,nextArrowPadding,arrowsPaddingY);}function placeElementsHor(){if(g_temp.arrowsVisible==true)placeElementsHor_arrows();else
placeElements_noarrows();}function placeElementsHorType_arrows(){var gridX,prevArrowX,nextArrowX,arrowsY;var objArrowSize=g_functions.getElementSize(g_objArrowPrev);var objGridSize=g_objGrid.getSize();switch(g_options.gridpanel_grid_align){default:case"left":gridX=g_options.gridpanel_padding_border_left+g_options.gridpanel_arrows_padding_hor+objArrowSize.width;break;case"middle":case"center":gridX="center";break;case"right":gridX=g_temp.panelWidth-objGridSize.width-objArrowSize.width-g_options.gridpanel_padding_border_right-g_options.gridpanel_arrows_padding_hor;break;}var gridElement=g_objGrid.getElement();g_functions.placeElement(gridElement,gridX,g_options.gridpanel_padding_border_top);objGridSize=g_objGrid.getSize();switch(g_options.gridpanel_arrows_align_vert){default:case"center":case"middle":arrowsY=(objGridSize.height-objArrowSize.height)/2+objGridSize.top;break;case"top":arrowsY=g_options.gridpanel_padding_border_top+g_options.gridpanel_arrows_padding_vert;break;case"bottom":arrowsY=g_temp.panelHeight-g_options.gridpanel_padding_border_bottom-g_options.gridpanel_arrows_padding_vert-objArrowSize.height;break;}switch(g_options.gridpanel_arrows_align_hor){default:case"borders":prevArrowX=g_options.gridpanel_padding_border_left;nextArrowX=g_temp.panelWidth-g_options.gridpanel_padding_border_right-objArrowSize.width;break;case"grid":prevArrowX=objGridSize.left-g_options.gridpanel_arrows_padding_hor-objArrowSize.width;nextArrowX=objGridSize.right+g_options.gridpanel_arrows_padding_hor;break;case"center":prevArrowX=(objGridSize.left-objArrowSize.width)/2;nextArrowX=objGridSize.right+(g_temp.panelWidth-objGridSize.right-objArrowSize.width)/2;break;}g_functions.placeElement(g_objArrowPrev,prevArrowX,arrowsY);g_functions.placeElement(g_objArrowNext,nextArrowX,arrowsY);}function placeElementHorType_noarrows(){var gridX;var objGridSize=g_objGrid.getSize();switch(g_options.gridpanel_grid_align){default:case"left":gridX=g_options.gridpanel_padding_border_left;break;case"middle":case"center":gridX="center";break;case"right":gridX=g_temp.panelWidth-objGridSize.width-g_options.gridpanel_padding_border_right;break;}var gridElement=g_objGrid.getElement();g_functions.placeElement(gridElement,gridX,g_options.gridpanel_padding_border_top);}function placeElementsHorType(){if(g_temp.arrowsVisible==true)placeElementsHorType_arrows();else
placeElementHorType_noarrows();}function placeElements(){if(g_temp.isHorType==false){if(g_options.gridpanel_vertical_scroll==true)placeElementsVert();else
placeElementsHor();}else{placeElementsHorType();}g_panelBase.placeElements();}this.getOrientation=function(){return(g_temp.orientation);}
this.setOrientation=function(orientation){g_temp.orientation=orientation;switch(orientation){case"right":case"left":g_temp.isHorType=false;break;case"top":case"bottom":g_temp.isHorType=true;break;default:throw new Error("Wrong grid panel orientation: "+orientation);break;}}
this.setHeight=function(height){if(g_temp.isHorType==true)throw new Error("setHeight is not appliable to this orientatio ("+g_temp.orientation+"). Please use setWidth");g_temp.panelHeight=height;var gridMaxHeight=getGridMaxHeight();g_objGrid.setMaxHeight(gridMaxHeight);}
this.setWidth=function(width){if(g_temp.isHorType==false)throw new Error("setWidth is not appliable to this orientatio ("+g_temp.orientation+"). Please use setHeight");g_temp.panelWidth=width;var gridMaxWidth=getGridMaxWidth();g_objGrid.setMaxWidth(gridMaxWidth);}
this.init=function(gallery,customOptions){initGridPanel(gallery,customOptions);}
this.setHtml=function(){setHtmlPanel();}
this.run=function(){runPanel();}
this.getElement=function(){return(g_objPanel);}
this.getSize=function(){var objSize=g_functions.getElementSize(g_objPanel);return(objSize);}
this.__________Functions_From_Base_____=function(){}
this.isPanelClosed=function(){return(g_panelBase.isPanelClosed());}
this.getClosedPanelDest=function(){return g_panelBase.getClosedPanelDest();}
this.openPanel=function(noAnimation){g_panelBase.openPanel(noAnimation);}
this.closePanel=function(noAnimation){g_panelBase.closePanel(noAnimation);}
this.setOpenedState=function(originalPos){g_panelBase.setOpenedState(originalPos);}
this.setClosedState=function(originalPos){g_panelBase.setClosedState(originalPos);}
this.setDisabledAtStart=function(timeout){g_panelBase.setDisabledAtStart(timeout);}}
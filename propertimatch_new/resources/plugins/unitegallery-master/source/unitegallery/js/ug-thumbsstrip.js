function UGThumbsStrip(){var t=this;var g_gallery=new UniteGalleryMain(),g_objGallery,g_objects,g_objWrapper;var g_arrItems,g_objStrip,g_objStripInner;var g_aviaControl,g_touchThumbsControl,g_functions=new UGFunctions();var g_isVertical=false,g_thumbs=new UGThumbsGeneral();var g_functions=new UGFunctions();var g_options={strip_vertical_type:false,strip_thumbs_align:"left",strip_space_between_thumbs:6,strip_thumb_touch_sensetivity:15,strip_scroll_to_thumb_duration:500,strip_scroll_to_thumb_easing:"easeOutCubic",strip_control_avia:true,strip_control_touch:true,strip_padding_top:0,strip_padding_bottom:0,strip_padding_left:0,strip_padding_right:0}
var g_temp={isRunOnce:false,is_placed:false,isNotFixedThumbs:false,handle:null};var g_sizes={stripSize:0,stripActiveSize:0,stripInnerSize:0,thumbSize:0,thumbSecondSize:0}
this.events={STRIP_MOVE:"stripmove"}
var g_defaultsVertical={strip_thumbs_align:"top",thumb_resize_by:"width"}
this.setHtml=function(objParent){if(!objParent){var objParent=g_objWrapper;if(g_options.parent_container!=null)objParent=g_options.parent_container;}objParent.append("<div class='ug-thumbs-strip'><div class='ug-thumbs-strip-inner'></div></div>");g_objStrip=objParent.children(".ug-thumbs-strip");g_objStripInner=g_objStrip.children(".ug-thumbs-strip-inner");g_thumbs.setHtmlThumbs(g_objStripInner);if(g_temp.isNotFixedThumbs==true)g_thumbs.hideThumbs();}
function ___________GENERAL___________(){};function initStrip(gallery,customOptions){g_objects=gallery.getObjects();g_gallery=gallery;g_gallery.attachThumbsPanel("strip",t);g_objGallery=jQuery(gallery);g_objWrapper=g_objects.g_objWrapper;g_arrItems=g_objects.g_arrItems;g_options=jQuery.extend(g_options,customOptions);g_isVertical=g_options.strip_vertical_type;if(g_isVertical==true){g_options=jQuery.extend(g_options,g_defaultsVertical);g_options=jQuery.extend(g_options,customOptions);customOptions.thumb_resize_by="width";}g_thumbs.init(gallery,customOptions);onAfterSetOptions();}function onAfterSetOptions(){var thumbsOptions=g_thumbs.getOptions();g_temp.isNotFixedThumbs=(thumbsOptions.thumb_fixed_size===false);g_isVertical=g_options.strip_vertical_type;}function runStrip(){g_thumbs.setHtmlProperties();initSizeParams();fixSize();positionThumbs();if(g_temp.isRunOnce==false){if(g_options.strip_control_touch==true){g_touchThumbsControl=new UGTouchThumbsControl();g_touchThumbsControl.init(t);}if(g_options.strip_control_avia==true){g_aviaControl=new UGAviaControl();g_aviaControl.init(t);}checkControlsEnableDisable();g_thumbs.loadThumbsImages();initEvents();}g_temp.isRunOnce=true;}function storeStripSize(size){g_sizes.stripSize=size;if(g_isVertical==false)g_sizes.stripActiveSize=g_sizes.stripSize-g_options.strip_padding_left-g_options.strip_padding_right;else
g_sizes.stripActiveSize=g_sizes.stripSize-g_options.strip_padding_top-g_options.strip_padding_bottom;if(g_sizes.stripActiveSize<0)g_sizes.stripActiveSize=0;}function initSizeParams(){var arrThumbs=g_objStripInner.children(".ug-thumb-wrapper");var firstThumb=jQuery(arrThumbs[0]);var thumbsRealWidth=firstThumb.outerWidth();var thumbsRealHeight=firstThumb.outerHeight();var thumbs_options=g_thumbs.getOptions();if(g_isVertical==false){g_sizes.thumbSize=thumbsRealWidth;if(thumbs_options.thumb_fixed_size==true){g_sizes.thumbSecondSize=thumbsRealHeight;}else{g_sizes.thumbSecondSize=thumbs_options.thumb_height;}storeStripSize(g_objStrip.width());g_sizes.stripInnerSize=g_objStripInner.width();}else{g_sizes.thumbSize=thumbsRealHeight;if(thumbs_options.thumb_fixed_size==true){g_sizes.thumbSecondSize=thumbsRealWidth;}else{g_sizes.thumbSecondSize=thumbs_options.thumb_width;}storeStripSize(g_objStrip.height());g_sizes.stripInnerSize=g_objStripInner.height();}}function setInnerStripSize(innerSize){if(g_isVertical==false)g_objStripInner.width(innerSize);else
g_objStripInner.height(innerSize);g_sizes.stripInnerSize=innerSize;checkControlsEnableDisable();}function positionThumbs(){var arrThumbs=g_objStripInner.children(".ug-thumb-wrapper");var posx=0;var posy=0;if(g_isVertical==false)posy=g_options.strip_padding_top;for(i=0;i<arrThumbs.length;i++){var objThumb=jQuery(arrThumbs[i]);if(g_temp.isNotFixedThumbs==true){objItem=g_thumbs.getItemByThumb(objThumb);if(objItem.isLoaded==false)continue;objThumb.show();}g_functions.placeElement(objThumb,posx,posy);if(g_isVertical==false)posx+=objThumb.outerWidth()+g_options.strip_space_between_thumbs;else
posy+=objThumb.outerHeight()+g_options.strip_space_between_thumbs;}if(g_isVertical==false)var innerStripSize=posx-g_options.strip_space_between_thumbs;else
var innerStripSize=posy-g_options.strip_space_between_thumbs;setInnerStripSize(innerStripSize);}function fixSize(){if(g_isVertical==false){var height=g_sizes.thumbSecondSize;var objCssStrip={};objCssStrip["height"]=height+"px";var objCssInner={};objCssInner["height"]=height+"px";}else{var width=g_sizes.thumbSecondSize;var objCssStrip={};objCssStrip["width"]=width+"px";var objCssInner={};objCssInner["width"]=width+"px";}g_objStrip.css(objCssStrip);g_objStripInner.css(objCssInner);}function scrollBy(scrollStep){var innerPos=t.getInnerStripPos();var finalPos=innerPos+scrollStep;finalPos=t.fixInnerStripLimits(finalPos);t.positionInnerStrip(finalPos,true);}function scrollToThumbMin(objThumb){var objThumbPos=getThumbPos(objThumb);var scrollPos=objThumbPos.min*-1;scrollPos=t.fixInnerStripLimits(scrollPos);t.positionInnerStrip(scrollPos,true);}function scrollToThumbMax(objThumb){var objThumbPos=getThumbPos(objThumb);var scrollPos=objThumbPos.max*-1+g_sizes.stripSize;scrollPos=t.fixInnerStripLimits(scrollPos);t.positionInnerStrip(scrollPos,true);}function scrollToThumb(objThumb){if(isStripMovingEnabled()==false)return(false);var objBounds=getThumbsInsideBounds();var objThumbPos=getThumbPos(objThumb);if(objThumbPos.min<objBounds.minPosThumbs){var prevThumb=objThumb.prev();if(prevThumb.length)scrollToThumbMin(prevThumb);else
scrollToThumbMin(objThumb);}else if(objThumbPos.max>objBounds.maxPosThumbs){var nextThumb=objThumb.next();if(nextThumb.length)scrollToThumbMax(nextThumb);else
scrollToThumbMax(objThumb);}}function scrollToSelectedThumb(){var selectedItem=g_gallery.getSelectedItem();if(selectedItem==null)return(true);var objThumb=selectedItem.objThumbWrapper;if(objThumb)scrollToThumb(objThumb);}function checkAndRepositionInnerStrip(){if(isStripMovingEnabled()==false)return(false);var pos=t.getInnerStripPos();var posFixed=t.fixInnerStripLimits(pos);if(pos!=posFixed)t.positionInnerStrip(posFixed,true);}function checkControlsEnableDisable(){var isMovingEndbled=isStripMovingEnabled();if(isMovingEndbled==true){if(g_aviaControl)g_aviaControl.enable();if(g_touchThumbsControl)g_touchThumbsControl.enable();}else{if(g_aviaControl)g_aviaControl.disable();if(g_touchThumbsControl)g_touchThumbsControl.disable();}}function alignInnerStrip(){if(isStripMovingEnabled())return(false);if(g_isVertical==false)g_functions.placeElement(g_objStripInner,g_options.strip_thumbs_align,0);else
g_functions.placeElement(g_objStripInner,0,g_options.strip_thumbs_align);}function ___________EVENTS___________(){};function onThumbClick(objThumb){if(t.isTouchMotionActive()){var isSignificantPassed=g_touchThumbsControl.isSignificantPassed();if(isSignificantPassed==true)return(true);}var objItem=g_thumbs.getItemByThumb(objThumb);g_gallery.selectItem(objItem);}function onThumbPlaced(){clearTimeout(g_temp.handle);g_temp.handle=setTimeout(function(){positionThumbs();},50);}function onItemChange(){var objItem=g_gallery.getSelectedItem();g_thumbs.setThumbSelected(objItem.objThumbWrapper);scrollToThumb(objItem.objThumbWrapper);}function initEvents(){g_thumbs.initEvents();var objThumbs=g_objStrip.find(".ug-thumb-wrapper");objThumbs.on("click touchend",function(event){var clickedThumb=jQuery(this);onThumbClick(clickedThumb);});g_objGallery.on(g_gallery.events.ITEM_CHANGE,onItemChange);if(g_temp.isNotFixedThumbs){jQuery(g_thumbs).on(g_thumbs.events.AFTERPLACEIMAGE,onThumbPlaced);}}this.destroy=function(){var objThumbs=g_objStrip.find(".ug-thumb-wrapper");objThumbs.off("click");objThumbs.off("touchend");g_objGallery.off(g_gallery.events.ITEM_CHANGE);jQuery(g_thumbs).off(g_thumbs.events.AFTERPLACEIMAGE);if(g_touchThumbsControl)g_touchThumbsControl.destroy();if(g_aviaControl)g_aviaControl.destroy();g_thumbs.destroy();}
function ____________GETTERS___________(){};function isStripMovingEnabled(){if(g_sizes.stripInnerSize>g_sizes.stripActiveSize)return(true);else
return(false);}function getThumbsInsideBounds(){var obj={};var innerPos=t.getInnerStripPos();obj.minPosThumbs=innerPos*-1+1;obj.maxPosThumbs=innerPos*-1+g_sizes.stripSize-1;return(obj);}function getThumbPos(objThumb){var objReturn={};var objPos=objThumb.position();if(g_isVertical==false){objReturn.min=objPos.left;objReturn.max=objPos.left+g_sizes.thumbSize;}else{objReturn.min=objPos.top;objReturn.max=objPos.top+g_sizes.thumbSize;}return(objReturn);}this.________EXTERNAL_GENERAL___________=function(){};this.init=function(gallery,customOptions){initStrip(gallery,customOptions);}
this.run=function(){runStrip();}
this.positionInnerStrip=function(pos,isAnimate){if(isAnimate===undefined)var isAnimate=false;if(g_isVertical==false)var objPosition={"left":pos+"px"};else
var objPosition={"top":pos+"px"};if(isAnimate==false){g_objStripInner.css(objPosition);t.triggerStripMoveEvent();}else{t.triggerStripMoveEvent();g_objStripInner.stop(true).animate(objPosition,{duration:g_options.strip_scroll_to_thumb_duration,easing:g_options.strip_scroll_to_thumb_easing,queue:false,progress:function(){t.triggerStripMoveEvent()},always:function(){t.triggerStripMoveEvent()}});}}
this.triggerStripMoveEvent=function(){jQuery(t).trigger(t.events.STRIP_MOVE);}
this.isTouchMotionActive=function(){if(!g_touchThumbsControl)return(false);var isActive=g_touchThumbsControl.isTouchActive();return(isActive);}
this.isItemThumbVisible=function(objItem){var objThumb=objItem.objThumbWrapper;var thumbPos=objThumb.position();var posMin=t.getInnerStripPos()*-1;if(g_isVertical==false){var posMax=posMin+g_sizes.stripSize;var thumbPosMin=thumbPos.left;var thumbPosMax=thumbPos.left+objThumb.width();}else{var posMax=posMin+g_sizes.stripSize;var thumbPosMin=thumbPos.top;var thumbPosMax=thumbPos.top+objThumb.height();}var isVisible=false;if(thumbPosMax>=posMin&&thumbPosMin<=posMax)isVisible=true;return(isVisible);}
this.getInnerStripPos=function(){if(g_isVertical==false)return g_objStripInner.position().left;else
return g_objStripInner.position().top;}
this.getInnerStripLimits=function(){var output={};if(g_isVertical==false)output.maxPos=g_options.strip_padding_left;else
output.maxPos=g_options.strip_padding_top;output.minPos=-(g_sizes.stripInnerSize-g_sizes.stripActiveSize);return(output);}
this.fixInnerStripLimits=function(distPos){var minPos;var objLimits=t.getInnerStripLimits();if(distPos>objLimits.maxPos)distPos=objLimits.maxPos;if(distPos<objLimits.minPos)distPos=objLimits.minPos;return(distPos);}
this.scrollForeward=function(){scrollBy(-g_sizes.stripSize);}
this.scrollBack=function(){scrollBy(g_sizes.stripSize);}
this.________EXTERNAL_SETTERS___________=function(){};this.setOptions=function(objOptions){g_options=jQuery.extend(g_options,objOptions);g_thumbs.setOptions(objOptions);onAfterSetOptions();}
this.setSizeVertical=function(height){if(g_isVertical==false){throw new Error("setSizeVertical error, the strip size is not vertical");return(false);}var width=g_sizes.thumbSecondSize;var objCssStrip={};objCssStrip["width"]=width+"px";objCssStrip["height"]=height+"px";g_objStrip.css(objCssStrip);storeStripSize(height);var objCssInner={};objCssInner["width"]=width+"px";objCssInner["left"]="0px";objCssInner["top"]="0px";g_objStripInner.css(objCssInner);g_temp.is_placed=true;checkControlsEnableDisable();}
this.setSizeHorizontal=function(width){if(g_isVertical==true){throw new Error("setSizeHorizontal error, the strip size is not horizontal");return(false);}var height=g_sizes.thumbSecondSize+g_options.strip_padding_top+g_options.strip_padding_bottom;var objCssStrip={};objCssStrip["width"]=width+"px";objCssStrip["height"]=height+"px";g_objStrip.css(objCssStrip);storeStripSize(width);var innerLeft=g_options.strip_padding_left;var objCssInner={};objCssInner["height"]=height+"px";objCssInner["left"]=innerLeft+"px";objCssInner["top"]="0px";g_objStripInner.css(objCssInner);g_temp.is_placed=true;checkControlsEnableDisable();}
this.setPosition=function(left,top,offsetLeft,offsetTop){g_functions.placeElement(g_objStrip,left,top,offsetLeft,offsetTop);}
this.resize=function(newSize){if(g_isVertical==false){g_objStrip.width(newSize);g_sizes.stripActiveSize=newSize-g_options.strip_padding_left-g_options.strip_padding_right;}else{g_objStrip.height(newSize);g_sizes.stripActiveSize=newSize-g_options.strip_padding_top-g_options.strip_padding_bottom;}storeStripSize(newSize);checkControlsEnableDisable();checkAndRepositionInnerStrip();alignInnerStrip();scrollToSelectedThumb();}
this.setThumbUnselected=function(objThumbWrapper){g_thumbs.setThumbUnselected(objThumbWrapper);}
this.setCustomThumbs=function(funcSetHtml){g_thumbs.setCustomThumbs(funcSetHtml);}
this.________EXTERNAL_GETTERS___________=function(){};this.getObjects=function(){var thumbsOptions=g_thumbs.getOptions();var commonOpitions=jQuery.extend(g_options,thumbsOptions);var obj={g_gallery:g_gallery,g_objGallery:g_objGallery,g_objWrapper:g_objWrapper,g_arrItems:g_arrItems,g_objStrip:g_objStrip,g_objStripInner:g_objStripInner,g_aviaControl:g_aviaControl,g_touchThumbsControl:g_touchThumbsControl,isVertical:g_isVertical,g_options:commonOpitions,g_thumbs:g_thumbs};return(obj);}
this.getObjThumbs=function(){return(g_thumbs);}
this.getSelectedThumb=function(){var selectedIndex=g_gallery.getSelectedItemIndex();if(selectedIndex==-1)return(null);return g_thumbs.getThumbByIndex(selectedIndex);}
this.getSizeAndPosition=function(){var obj=g_functions.getElementSize(g_objStrip);return(obj);}
this.getHeight=function(){var stripHeight=g_objStrip.outerHeight();return(stripHeight)}
this.getWidth=function(){var stripWidth=g_objStrip.outerWidth();return(stripWidth);}
this.getSizes=function(){return(g_sizes);}
this.isVertical=function(){return(g_isVertical);}
this.isPlaced=function(){return(g_temp.is_placed);}
this.isMoveEnabled=function(){var isEnabled=isStripMovingEnabled();return(isEnabled);}}